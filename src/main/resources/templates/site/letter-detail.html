<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>lsyy论坛-私信详情</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">

    <!-- Bootstrap CSS-->
    <link rel="stylesheet" th:href="@{/vendor/bootstrap/css/bootstrap.css}">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
          integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <!-- Google fonts - Popppins for copy-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,800">
    <!-- orion icons-->
    <link rel="stylesheet" th:href="@{/css/orionicons.css}">
    <!-- theme stylesheet-->
    <link rel="stylesheet" th:href="@{/css/style.default.css}" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" th:href="@{/css/custom.css}">

    <!-- Favicon-->
    <link rel="shortcut icon" th:href="@{/img/favicon.png?3}">
    <link rel="icon" href="https://static.nowcoder.com/images/logo_87_87.png"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/letter.css}"/>
    <!-- Tweaks for older IEs--><!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <script th:src="@{/js/jquery-3.3.1.js}"></script>
    <![endif]-->
</head>


<body>
<!-- navbar-->
<!-- 引头部-->
<div th:replace="~{commons/commons::topbar}"></div>
<div class="d-flex align-items-stretch">
    <!--      引左边-->
    <div th:replace="~{commons/commons::specialsidebar(active='letter-detail.html')}"></div>
    <!--      引左边结束-->

    <!--    正文-->
    <div class="page-holder w-100 d-flex flex-wrap">
        <div class="container-fluid px-xl-5">
            <section class="py-5">
                <div class="row">

                </div>
            </section>
            <section>
                <div class="row mb-4" style="width: 2700px">
                    <div class="col-lg-7 mb-4 mb-lg-0">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="h6 text-uppercase mb-0"></h2>
                            </div>
                            <!--                            功能模块-->
                            <div class="container p-5 mt-3 mb-3">

                                <!-- 内容 -->
                                <div class="main">
                                    <div class="container">
                                        <div class="row">
                                            <div class="col-8">
                                                <h6><b class="square"></b> 来自 <i class="text-success"
                                                                                 th:utext="${target.username}">落基山脉下的闲人</i>
                                                    的私信</h6>
                                            </div>
                                            <div class="col-4 text-right">
                                                <button type="button" class="btn btn-secondary btn-sm"
                                                        onclick="backhome();">返回
                                                </button>

                                            </div>
                                        </div>
                                        <!--										&lt;!&ndash; 弹出框 &ndash;&gt;-->
                                        <!--										<div class="modal fade" id="sendModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">-->
                                        <!--											<div class="modal-dialog modal-lg" role="document">-->
                                        <!--												<div class="modal-content">-->
                                        <!--													<div class="modal-header">-->
                                        <!--														<h5 class="modal-title" id="exampleModalLabel">发私信</h5>-->
                                        <!--														<button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
                                        <!--															<span aria-hidden="true">&times;</span>-->
                                        <!--														</button>-->
                                        <!--													</div>-->
                                        <!--													<div class="modal-body">-->
                                        <!--														<form>-->
                                        <!--															<div class="form-group">-->
                                        <!--																<label for="recipient-name" class="col-form-label">发给：</label>-->
                                        <!--																<input type="text" class="form-control" id="recipient-name" th:value="${target.username}">-->
                                        <!--															</div>-->
                                        <!--															<div class="form-group">-->
                                        <!--																<label for="message-text" class="col-form-label">内容：</label>-->
                                        <!--																<textarea class="form-control" id="message-text" rows="10"></textarea>-->
                                        <!--															</div>-->
                                        <!--														</form>-->
                                        <!--													</div>-->
                                        <!--													<div class="modal-footer">-->
                                        <!--														<button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>-->
                                        <!--														<button type="button" class="btn btn-primary" id="sendBtn">发送</button>-->
                                        <!--													</div>-->
                                        <!--												</div>-->
                                        <!--											</div>-->
                                        <!--										</div>-->


                                        <!-- 私信列表 -->
                                        <ul class="list-unstyled mt-4">
                                            <li class="media pb-3 pt-3 mb-2" th:each="map:${letters}">

                                                <a href="#" th:if="${target.username==map.fromUser.username}">
                                                    <img th:src="${map.fromUser.headerUrl}" width="50px" height="50px"
                                                         class="mr-4 rounded-circle user-header" alt="用户头像">
                                                </a>
                                                <div class="toast show d-lg-block" role="alert" aria-live="assertive"
                                                     aria-atomic="true">
                                                    <div class="toast-header">
                                                        <strong class="mr-auto" th:utext="${map.fromUser.username}">落基山脉下的闲人</strong>
                                                        <small th:text="${#dates.format(map.letter.createTime,'yyyy-MM-dd HH:mm:ss')}">2019-04-25
                                                            15:49:32</small>
                                                        <button type="button" class="ml-2 mb-1 close"
                                                                data-dismiss="toast" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>

                                                    <div class="toast-body" th:utext="${map.letter.content}">
                                                        君不见, 黄河之水天上来, 奔流到海不复回!
                                                    </div>
                                                </div>
                                                <a href="#" style="margin-left: 20px"
                                                   th:if="${target.username!=map.fromUser.username}">
                                                    <img th:src="${map.fromUser.headerUrl}" width="50px" height="50px"
                                                         class="mr-4 rounded-circle user-header" alt="用户头像">
                                                </a>

                                            </li>
                                        </ul>

                                        <br><br>
                                        <!-- 回帖输入 -->

                                        <form method="post" action="">
                                            <p class="mt-3">

                                                <input type="hidden" id="recipient-name" th:value="${target.username}">
                                                <textarea placeholder="发送消息" name="message-text" id="message-text"
                                                          style="width: 500px"></textarea>
                                            </p>
                                            <p>
                                                <button type="button" class="btn btn-primary btn-sm" id="sendBtn"
                                                        style="float: left">&nbsp;&nbsp;发送&nbsp;&nbsp;
                                                </button>
                                            </p>
                                        </form>

                                        <!-- 提示框 -->
                                        <div class="modal fade" id="hintModal" tabindex="-1" role="dialog"
                                             aria-labelledby="hintModalLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-lg" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="hintModalLabel">提示</h5>
                                                    </div>
                                                    <div class="modal-body" id="hintBody">
                                                        发送完毕!
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 分页 -->
                                        <br><br>
                                        <div th:replace="~{commons/commons::pagination}"></div>
                                    </div>
                                </div>
                                <!--      引底部-->
                                <div th:replace="~{commons/commons::footbar}"></div>
                            </div>

                            <script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
                            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
                                    crossorigin="anonymous"></script>
                            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
                                    crossorigin="anonymous"></script>
                            <script th:src="@{/js/global.js}"></script>
                            <script th:src="@{/js/letter.js}"></script>
                            <script>
                                function backhome() {
                                    location.href = "/letter/list";
                                }
                            </script>

                            <script>


                                // 自动跳转到最新的消息页
                                $(function () {
                                    //剪切url，只要最后一个‘/’后面的值
                                    var url=location.href;
                                    var number = url.lastIndexOf("/");
                                    var newUrl = url.substring(number);
                                    var flag=newUrl.indexOf("current") >0 ;
                                    if(!flag){
                                        document.getElementById("lastpage").click();

                                    }

                                });
                            </script>
                        </div>
</body>
</html>
